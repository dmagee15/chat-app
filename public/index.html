<!DOCTYPE html>

<html>

	<head>
		<title>Stock Market App</title>
		<script type="text/javascript" src="/public/jquery-3.2.1.min.js"></script>
		<script src="https://code.highcharts.com/stock/highstock.js"></script>
		<script src="https://code.highcharts.com/stock/modules/exporting.js"></script>
		<script src="https://unpkg.com/react@15.3.2/dist/react.js"></script>
		<script src="https://unpkg.com/react-dom@15.3.2/dist/react-dom.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>
	</head>

	<body>
		<div id="container"></div>
		<script src="/public/index.js"></script>
		<script type="text/babel">
		
			/*
			var destination = document.querySelector("#container");
			
			var App = React.createClass({
				render: function(){
					return (
						<div>
						<StockChartContainer/>
						<input type="text" name="title" value="Mr." />
						</div>
						);
				}	
			});
			
			var StockChartContainer = React.createClass({
				
				render: function(){
					
					var divStyle = {
					width: '100%'
					}
					var outerDivStyle = {
						textAlign:'center'
					}
					
					return (
						<div style={outerDivStyle}>
							<h1>Charting the Stock Market</h1>
							<div style={divStyle}>
								<StockChart/>
							</div>
						</div>
						);
				}	
			});
			
			var StockChart = React.createClass({

				render: function(){
					
					var divStyle = {
					margin:'auto',
					padding:0,
					width: '95%',
					height: 500
					}
					
					return (
						<div style={divStyle} id="chart">
						</div>
						);
				}	
			});
			
			ReactDOM.render(
				<div>
					<App/>
				</div>,
				destination
				);
				
				function initializeChart(){
					$.ajax({
        		url:'/retrievedata',
        		type:'get',
        		success:function(serverData){
            		console.log(serverData[0]);
            		var newArray = [];
            		serverData.forEach(function(item) {
					var val = [(new Date(item.date)).getTime(),item.open];
					newArray.push(val);
					});
            	console.log(newArray);
            	
            	Highcharts.stockChart('chart', {
        		rangeSelector: {
            		selected: 3
        		},
        		title: {
        		    text: 'AAPL Stock Price'
        		},
        		series: [{
        		    name: 'AAPL',
        		    data: newArray.sort(function(a, b) {
        return a[0] - b[0]; }),
        		    color: 'red',
        		    tooltip: {
        		        valueDecimals: 2
        		    }
        		}]
    		});
            	
            	
        		}
    		});
				}
				
				initializeChart();
				*/
		</script>
		
	</body>

</html>